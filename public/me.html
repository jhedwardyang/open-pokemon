<html>
	<head>
		<title>ME TEST</title>
	</head>
<body>
	<div id="test"></div>
	<script type="text/javascript" src="/assets/jquery-2.1.1.min/jquery-2.1.1.min.js"></script>
	<script type="text/javascript">
	window.addEventListener("devicemotion", accelerometerUpdate, true);
	var alpha = 0.15;
var s_T = 0;
var max = -10;
var min = 1000;
var last = [];
setTimeout(function(){
  	$.post("/data/", {data:$("#test").val()});
  }, 3000);
function accelerometerUpdate(e) {
  var aX = event.accelerationIncludingGravity.x;
  var aY = event.accelerationIncludingGravity.y;
  var aZ = event.accelerationIncludingGravity.z;
  if(Math.abs(last[0]-aX)+Math.abs(last[1]-aY)+Math.abs(last[2]-aZ) < 1.8) {
  	//ignore
  } else {
  	$("#test").append(aX+","+aY+","+aZ);
  	//http://stackoverflow.com/questions/16392142/android-accelerometer-profiling/16539643#16539643
	  var g = Math.pow(aX,2)+Math.pow(aY,2)+Math.pow(aZ,2);
	  s_T = alpha * g + (1 - alpha) * s_T;
	  if(g > max) max = g;
	  if(g < min) min = g;
	  if(g > s_T && (g > max*2/3 || g < min*2/3)) {
	    step();
	    $("#test").html("STEPPPP!!!!!!");
	  }
  }

  last = [aX, aY, aZ];
}
	</script>
</body>
</html>